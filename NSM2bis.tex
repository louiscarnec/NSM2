\documentclass[a4paper,11pt]{article}
\usepackage{graphicx}
\usepackage{lscape}
\usepackage{capt-of}
\usepackage{fancyhdr}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{enumerate}
\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usepackage{url}
\usepackage{enumerate}
\usepackage{siunitx}
\usepackage{eurosym}
\usetikzlibrary{quotes,angles,positioning}
\usepackage{standalone}
\usepackage{multirow}
\usepackage{url}
\usepackage{float}
\usepackage{geometry} % to change the page dimensions


\newcommand{\subf}[2]{%
  {\small\begin{tabular}[t]{@{}c@{}}
  #1\\#2
  \end{tabular}}%
}  

\geometry{a4paper} 
\pagestyle{fancy}
\lhead{}
\rhead{}
\renewcommand{\headrulewidth}{0pt}
\setlength\parindent{0pt}
\usepackage{amstext} % for \text
\DeclareRobustCommand{\officialeuro}{%
  \ifmmode\expandafter\text\fi
  {\fontencoding{U}\fontfamily{eurosym}\selectfont e}}
\setlength{\parindent}{5ex}

\begin{document}
\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries Network Software Modelling Assignment 2}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Students:}\\
Louis \textsc{Carnec} \\% Your name
Vijay \textsc{Katta}\\
Adedayo \textsc{Adelowokan}  
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Student \#:} \\
15204934 \\ 15202724 \\15204151 % Supervisor's Name
\end{flushright}
\end{minipage}\\[4cm]

% If you don't want a supervisor, uncomment the two lines below and remove the section above
%\Large \emph{Author:}\\
%John \textsc{Smith}\\[3cm] % Your name

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------

{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise

%----------------------------------------------------------------------------------------
%	LOGO SECTION
%----------------------------------------------------------------------------------------

%\includegraphics{Logo}\\[1cm] % Include a department/university logo - this will require the graphicx package
 
%----------------------------------------------------------------------------------------

{

	 \vspace{1.5in}\textmd{\textbf{Master of Science (Business Analytics)}}\\
     \large{\textbf{UCD Michael Smurfit Graduate Business School }}\\
      \textmd{\textbf{2016-2017}}\\
 }     
\vfill % Fill the rest of the page with whitespace

\end{titlepage}





\section{Real world phenomenon: Spread of disease through airports network} 


The world is more closely connected than ever before by modern transportation networks. Air, sea and land transportation continues to expand in reach, speed of travel and volume of passengers and goods carried. Pathogens and their vectors can now move further, faster and in greater numbers than ever before \cite{tatem2006global}. Epidemics can occur more easily and the emergence of novel pathogens exacerbates the situation \cite{jones2008global}. Understanding the dispersal behaviour and identifying the outbreak of an epidemic in its preliminary stages enables critical response planning. Network topology properties that surround the debut location can explain much of the early stage variation in the spread of diseases \cite{lawyer2016measuring}.

In this simulation we will model the spread of disease through the US airport network. It is inspired by the work of Yager and Taylor \cite{nicholasyager2014} which model the spread of pathogens through airports around the world using a directed graph. We will extend their work by testing how graphs (subgraphs of the US networks graph with specific properties and Erdos-Renyi graphs with different edge existence probabilities) and initial infection nodes (with different centrality measures) affect the spread of disease through the network.

\section{US Airport Network Model}

Our real-world network graph is undirected where nodes represent airports and edges are routes. We used open source data from \url{http://openflights.org}along with population of US cities from \url{https://unstats.un.org/unsd/demographic/products/dyb/City_Page.htm}. Redundant edges and unconnected nodes were removed from the graph. Edge weights were calculates by getting the average population of the two cities connected by edges and normalising for all edges. In creating the graph, only edges connecting airports with the US were added.
The graph created deviates from the real world epidemic scenario. Firstly, exclusively flights within the US are considered. In reality, disease spread through air transport is a world wide phenomenon. In a world wide scenario, we could expect the spread of disease across US nodes to be even quicker as more edges would connect US airport hubs. Secondly, the graph is undirected, this is due to the fact that there is no data for passenger numbers on specific routes. We assume that passenger on routes is proportional to the population of the city which is served by an airport. It is also assumed that routes are bidirectional, to simplify.


\section{Simulation Rules}

The states of each node/airport are either; susceptible to infection (green), infected (yellow) or dead/closed down (red). All nodes are initially disease free and thus susceptible to infection except from a node which is infected at the beginning, step 0. Once a node is infected, it can infect any of its neighbours with probability related to the edge weight connecting it to its neighbours. In the case where the airport can close down or dies (these terms will be used interchangeably), if the airport has closed down it cannot spread anymore disease, there are no outgoing flights. 


Nodes are coloured based on the status - green is susceptible, yellow is infected and red is removed/dead. The four $K_{2,2}$ graphs in Figures \ref{fig:M1} and \ref{fig:M2} below each one represent the state of nodes in a graph at one time step. Figure \ref{fig:M1} (a), demonstrates the initial state, where node A is infected (yellow) and all other nodes are susceptible (green). In Figure \ref{fig:M1} (b), nodes B and D are infected with probabilities ${\emph{w} _{AB}}$  and ${\emph{w}_{DA}}$ respectively, as they are the neighbours of node A. Figure \ref{fig:M2} (a) shows that all nodes are infected and in (b), the next time step, nodes B and D are red, they are dead/closed indefinitely. 

When a node is dead, it cannot further spread the disease. Therefore, if for example the initial node dies before spreading the disease to a neighbour, for example if it has a low probability of spreading the disease, the spread of the disease will be stopped prematurely.

\begin{figure}[H]
	\begin{subfigure}{.22\textwidth}
        %\centering
		\begin{tikzpicture}
			\begin{scope}[every node/.style={circle,thick,draw},local bounding box=aa]
    \node[fill = yellow] (A) at (0,0) {A};
    \node[fill = green] (B) at (0,2) {B};
     \node[fill = green]  (C) at (2,2) {C};
     \node[fill = green]  (D) at (2,0) {D};
			\end{scope}
			\begin{scope}[>={Stealth[black]},
              every node/.style={fill=white,circle},
              every edge/.style={draw=red,very thick}]
    \path [-] (A) edge node {$w_{AB}$} (B);
    \path [-] (B) edge node {$w_{BC}$} (C);
   \path [-] (C) edge node {$w_{CD}$} (D);
    \path [-] (D) edge node {$w_{DA}$}(A);
			\end{scope}
		\end{tikzpicture}
\caption{Initial node A infected}
        \label{fig:myfirstsubfig}
    \end{subfigure}%
\begin{subfigure}{.22\textwidth}
        %\centering
        \begin{tikzpicture}
\begin{scope}[every node/.style={circle,thick,draw},shift={(4,0)},local bounding box=bb]
    \node[fill = yellow] (A) at (0,0) {A};
    \node[fill = yellow] (B) at (0,2) {B};
     \node[fill = green]  (C) at (2,2) {C};
     \node[fill = yellow]  (D) at (2,0) {D};
\end{scope}
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=white,circle},
              every edge/.style={draw=red,very thick}]
    \path [-] (A) edge node {$w_{AB}$} (B);
    \path [-] (B) edge node {$w_{BC}$} (C);
   \path [-] (C) edge node {$w_{CD}$} (D);
    \path [-] (D) edge node {$w_{DA}$}(A);
\end{scope}
\end{tikzpicture}
        \caption{B and D infected}
        \label{fig:mysecondsubfig}
    \end{subfigure}
\begin{subfigure}{.22\textwidth}
        %\centering
        \begin{tikzpicture}
\begin{scope}[every node/.style={circle,thick,draw},shift={(8,0)},local bounding box=bb]
    \node[fill = yellow] (A) at (0,0) {A};
    \node[fill = yellow] (B) at (0,2) {B};
     \node[fill = yellow]  (C) at (2,2) {C};
     \node[fill = yellow]  (D) at (2,0) {D};
\end{scope}
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=white,circle},
              every edge/.style={draw=red,very thick}]
    \path [-] (A) edge node {$w_{AB}$} (B);
    \path [-] (B) edge node {$w_{BC}$} (C);
   \path [-] (C) edge node {$w_{CD}$} (D);
    \path [-] (D) edge node {$w_{DA}$}(A);
\end{scope}
\end{tikzpicture}
        \caption{All nodes infected}
        \label{fig:mysecondsubfig}
    \end{subfigure}
    \begin{subfigure}{.22\textwidth}
        %\centering
        \begin{tikzpicture}
\begin{scope}[every node/.style={circle,thick,draw},shift={(8,0)},local bounding box=bb]
    \node[fill = yellow] (A) at (0,0) {A};
    \node[fill = red] (B) at (0,2) {B};
     \node[fill = yellow]  (C) at (2,2) {C};
     \node[fill = red]  (D) at (2,0) {D};
\end{scope}
\begin{scope}[>={Stealth[black]},
              every node/.style={fill=white,circle},
              every edge/.style={draw=red,very thick}]
    \path [-] (A) edge node {$w_{AB}$} (B);
    \path [-] (B) edge node {$w_{BC}$} (C);
   \path [-] (C) edge node {$w_{CD}$} (D);
    \path [-] (D) edge node {$w_{DA}$}(A);
\end{scope}
\end{tikzpicture}
        \caption{Infected nodes die}
        \label{fig:mysecondsubfig}
    \end{subfigure}
\caption{Spread of Infection Simulation Rules} \label{fig:M2}
\end{figure}

\section{Simulation and Graph Properties}

\subsection*{Simulation Properties}
We will investigate two main simulation properties; with and without airports being able to close or nodes dying. The hypothesis is that the spread of the disease throughout the network will be slowed down by airport closing as, at each time-step, they cannot spread the disease to neighbours once closed down. \\
Each simulation depends on the probability of being infected at a given timestep ($p_{infection}$) and the time after infection at which the node dies. In both cases $p_{infection} = 0.4$ for simplicity, that is the probability an infected node will infect a neighbour is 0.4, if the edge weight is 1.0. The second simulation, where airports can close, also depends on the time after infection when the airport closes (set in the initial simulation to 4 time steps). We would expect both parameters to have an effect on the spread of disease. The greater the probability of infection, the faster the spread. The longer it takes for the airport to close, the faster the rate of infection. And vice versa. 

\subsection*{Graph Properties}
We hypothesise that the simulations will depend on:

\begin{itemize}
\item Diameter: the largest distance between any two nodes in the graph. The greater the diameter, the longer it should take for the disease to infect the whole graph.
\item Centrality of initial node. The more central an airport/node the faster the disease should spread to other nodes in the network. We will investigate degree centrality and betweenness centrality.
\end{itemize}

\section{Experiments}

The experiments were conducted using 25 time steps, as a result some simulations did not run until the whole graph was infected. Due to the large number of results produced by the experiments, a subset will be presented here. When comparing initial node centrality between the real world graph and generated graphs, the Erdos-Renyi generated graphs were created with 143 nodes to mimic the real-world graph of the same order.

\subsection*{Testing Diameter Hypothesis}
Both simulations were tested on the airport network and its subgraphs and a range of Erdos-Renyi random graphs for different sizes and probabilities of edge existence. The full US airport graph as a diameter of 4, that is any two airports within the graph have at most 2 airports between them. Subgraphs of the US airport graph are investigated; a subgraph with edge weights $> 0.75$(diameter is infinite, graph not connected), subgraph with edge weights $<0.5$ (diameter = 3), subgraph of 20 largest degree centrality nodes (diameter = 2), and the minimum spanning tree of the airport graph (diameter = 8).\\
Erdos-Renyi graphs' diameter depends on the choice of $n$ (the order of the graph) and $pn$ (probability of an edge existing).

\subsection*{Testing Node Centrality}
Tests were also conducted using specific nodes for initial infection based on centrality. The nodes with highest and lowest betweenness and degree centrality, as well as the centre node were infected at time 0 to test their effect on both the real world and Erdos-Renyi graphs.

\section{Results}

\subsection*{Diameter}
\subsubsection*{Real World Graph and Subgraphs}
The spread of the disease through the graphs differs greatly as we expected depending on the graph we are testing on for both scenarios 1 and 2 (see Figures 4,5,12,13). In scenario 1, the disease spreads quickly, by the 5th time step, 90\% of the graph is infected but the rate of spread greatly levels out thereafter. Comparing large and low edge weight graphs, the spread for the large edge weight graph is slow whereas it is fast in the low edge weight case. The disease does not spread to the whole graph in the 25 steps of the run but levels out. This has to do with the fact that the whole graph is not connected (diameter = inf). With the 20 largest degree centrality node subgraph, the spread is much quicker than in all other graphs, the disease has spread to the graph in 3 time steps. The minimum spanning tree is slow to spread, it takes some time before the disease reaches a high centrality node, at which point the disease spreading rate increases. In the second simulation, in both subgraphs (largest and lowest edge weights), the disease doesn?t spread to the entirety of the graph. In the case of largest edge weights the disease spreads at a slower rather to that of the lowest edge weights subgraph. For our largest degree centrality node sub graph, the disease spreads at very high rate and by the 7$^th$ time step the whole graph is closed/dead.Although interesting, these results do not tell much about the effect of graph diameter on disease spread. It is more likely that the properties of the nodes within the subgraphs (edge weights, degree centrality of nodes, minimum spanning tree nodes) explain the rate of disease spread for the different subgraphs tested.

\subsection*{Centrality}
\subsubsection*{Erdos-Renyi}

When comparing how the degree centrality of the source node affects the spread of the disease. We compared the spread of the disease throughout the graph using initials nodes with the highest and lowest degree centrality. The behaviour between both nodes are quite similar with a slightly slower rate of infection in the case of the node with lowest degree centrality. Using an initial node with max degree centrality, the graph is infected by the 8$^th$ time step. The more edges a node has the quicker we would expect it to spread the disease to the rest of the graph. Table 2 shows that for the generated graphs, using min degree centrality always results in slower graph infection. See Figure 6 in Appendix.In the second simulation, in which airports can close, in both cases where the initial node is of lowest or highest degree centrality we observed that nodes begin to die off when the number of infected nodes is at its peak. Interestingly, for graphs of size n=150 and n=250, the time it takes to spread the disease is closer for both centrality measures than in simulation 1. See Figure 14.Examining the effect of using initial nodes with minimum and maximum betweenness centrality, we find that in the first simulation when the source node has high betweenness centrality the disease spreads at a higher rate than using minimum betweenness centrality. In the second simulation, the behaviour is similar to that of the first scenario and as noted above the death rate is also similar. See Figure 7 in Appendix.

\subsubsection*{Real World Graph}

In our real world graph, a minimum degree centrality node, the rate of spread is similar to the Erdos-Renyi graphs. The rate of the spread is a lot faster using a max degree centrality source node in the real-world graph compared to the spread observed in the Erdos-Renyi graphs. In the second simulation we observe the same situation to airports being closed off, it starts at the point where the infected nodes reaches its peak. The behaviour is also similar to that of the observed Erdos-Renyi graph. See Figure 8,9,14.Betweenness and degree centrality nodes, whether minimum or maximum, have similar behaviours in both generated and real-world graphs.

\subsection*{Generated Graph Order}
Interestingly, we find that graph order is inversely proportional to the time until all nodes are infected/dead, as well as graph diameter (more nodes results in more edges thus lower diameter). Comparing both simulations, for smaller graph order (n = 150, 250) simulation 2 takes less than half the time to infect the graph of simulation 1, while it takes more than half the time for larger order graphs (n = 500, 1000). 

\begin{table}[H]
\centering

\label{sim1stats}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c||c|c|c|c|c|c|c|c}
\hline
GraphType& Order & Diameter & Center  Of Graph& Min Deg Centrality& Max Deg Centrality &Min Btwnes Centrality&Max Btwnes Centrality\\
 \hline
Real-World &	143	&4&9&	inf	&8	&12	&inf\\
  \hline
Erdos Renyi &	150	&4&	6	& 11&5	&7	&5\\
  \hline
Erdos Renyi &	250	&3&	5	&6 &4	&6	&4\\
 \hline
  Erdos Renyi &	500	&3&	5	&5 &4	&5	&3\\
  \hline
Erdos Renyi &	1000	&3&	3	&3 &2	&3	&3\\
 \hline
\end{tabular}}

\caption{Simulation 1 : Time Step - When entire network is infected}
\end{table}


\begin{table}[H]
\centering

\label{sim2stats}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c||c|c|c|c|c|c|c|c}
\hline
GraphType& Order & Diameter & Center  Of Graph& Min Deg Centrality& Max Deg Centrality &Min Btwnes Centrality&Max Btwnes Centrality\\
 \hline
Real-World &	143	&4&	inf	&inf	&inf	&inf	&inf\\
  \hline
Erdos Renyi &	150	&4&	10	&13 &11	&12	&11\\
  \hline
Erdos Renyi &	250	&3&	10	&11 &10	&10	&9\\
 \hline
  Erdos Renyi &	500	&3&	8	&8 &8	&9	&8\\
  \hline
Erdos Renyi &	1000	&3&	7	&8 &7	&8	&7\\
 \hline
\end{tabular}}

\caption{Simulation 2 : Time Step - When all nodes are closed/removed}
\end{table}

\section{Conclusions}

In conclusion after observing the Erdos-Renyi and our real graph, the effect the of the chosen nodes in both situations, degree and betweenness centrality there was no obvious difference in the behaviour of the disease of the graph. 

The starting node used affects the spread of disease throughout the graph. Examining spring layout plots for each time step of the simulation and node state percentage plots we uncovered some interesting cases. If the initial node used has no edges, unsurprisingly the disease does not spread to the graph. If the node has edges with low weight, the spread of disease is slow until it reaches a node with high centrality. Thus, if a disease is initiated in a small regional airport, the spread will turn into an epidemic once a major airport is infected.  In the second scenario, we found that for some runs using airports with low edge weights / betweenness centrality / degree centrality, (low edge weights results in lower probability of spreading to neighbour node) the infected airport will shut before the disease spreads to neighbouring nodes. Closing an infected airport can stop the spread of disease. The sooner the airport closes, the less likely the disease is to spread.


\section{Appendix}

\input{pictures.tex}






\bibliographystyle{acm}
\bibliography{NSM.bib}










\end{document}

